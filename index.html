<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#3b82f6">
<title>app-bloque</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div id="logo">app-bloque</div>
</header>

<!-- Toast Notification -->
<div id="toast-notification" class="toast hidden"></div>

<section id="home-section">
    <div class="home-header">
        <div class="header-top">
            <button id="options-btn" class="menu-btn">â˜°</button>
            <button id="new-block-btn">+ Crear Bloque</button>
            <input type="text" id="search-input" placeholder="Buscar por nombre, grado (ej: 6a) o zona...">
        </div>
        <div class="filters">
            <select id="filter-grade"></select>
            <select id="filter-zone"></select>
            <button id="filter-favorites-btn" class="filter-btn">â˜† Favoritos</button>
        </div>
    </div>
    <div id="blocks-grid"></div>
</section>

<!-- Modal de Opciones -->
<div id="options-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Opciones</h2>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="stats-section">
                <h3>EstadÃ­sticas</h3>
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-label">Total de VÃ­as</span>
                        <span class="stat-value" id="modal-stat-total">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">VÃ­as Favoritas</span>
                        <span class="stat-value" id="modal-stat-favorites">0</span>
                    </div>
                </div>
            </div>
            
            <div class="actions-section">
                <h3>SincronizaciÃ³n</h3>
                <button id="modal-export-btn" class="full-width">ðŸ“¤ Exportar Bloques</button>
                <button id="modal-import-btn" class="full-width">ðŸ“¥ Importar Bloques</button>
                <button id="modal-backup-btn" class="full-width backup-btn">ðŸ’¾ Guardar Respaldo Completo</button>
                <input type="file" id="import-file" accept=".json" style="display:none;">
            </div>
            
            <div class="info-section">
                <h3>InformaciÃ³n</h3>
                <p><strong>ðŸ“¤ Exportar:</strong> Selecciona bloques especÃ­ficos para compartir.</p>
                <p><strong>ðŸ“¥ Importar:</strong> Carga bloques compartidos (se fusionan con los existentes).</p>
                <p><strong>ðŸ’¾ Respaldo Completo:</strong> Descarga TODOS tus bloques automÃ¡ticamente. En iPhone, elige la carpeta donde guardar (Archivos, iCloud Drive, etc.).</p>
            </div>
        </div>
    </div>
</div>

<!-- Modal de SelecciÃ³n para Exportar -->
<div id="export-modal" class="modal hidden">
    <div class="modal-content export-modal-content">
        <div class="modal-header">
            <h2>Seleccionar Bloques a Exportar</h2>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="export-controls">
                <button id="select-all-btn" class="btn-select-all">Seleccionar Todos</button>
                <button id="deselect-all-btn" class="btn-select-all">Deseleccionar Todos</button>
            </div>
            <div id="export-blocks-list" class="export-blocks-list">
                <!-- Se rellenarÃ¡ dinÃ¡micamente -->
            </div>
            <div class="export-actions">
                <button id="confirm-export-btn" class="btn-export">Exportar Seleccionados</button>
                <button id="cancel-export-btn" class="btn-cancel">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Fullscreen para Zoom de Imagen -->
<div id="image-zoom-modal" class="modal hidden" style="z-index: 2000; background: rgba(0,0,0,0.95);">
    <div style="position: relative; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; overflow: hidden;">
        <button id="close-zoom-btn" style="position: fixed; top: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.3); font-size: 32px; cursor: pointer; z-index: 2001; transition: all 0.3s ease; padding: 0; display: flex; align-items: center; justify-content: center;">Ã—</button>
        <img id="zoom-image" src="" alt="Imagen ampliada" style="max-width: 100%; max-height: 100%; object-fit: contain; cursor: grab;">
    </div>
</div>

<section id="view-block-section">
    <canvas id="view-block-canvas"></canvas>
    <button id="toggle-info-btn">Ver InformaciÃ³n</button>
    <div id="view-block-info" class="collapsed">
        <h3 id="view-block-name"></h3>
        <p><strong>Grado:</strong> <span id="view-block-grade"></span></p>
        <p><strong>Zona:</strong> <span id="view-block-zone"></span></p>
        <p><strong>Notas:</strong> <span id="view-block-notes"></span></p>
    </div>
    <div class="view-actions">
        <button id="toggle-favorite-btn">â˜† Marcar Favorito</button>
        <button id="edit-from-view-btn">Editar Bloque</button>
        <button class="back-btn">Volver</button>
    </div>
</section>

<section id="new-block-section">
    <h2>Crear Nuevo Bloque</h2>
    <div id="photo-wrapper">
        <div id="photo-placeholder">Foto</div>
        <input type="file" id="photo-input" accept="image/*">
        <div id="photo-preview"></div>
    </div>

    <input type="text" id="block-name" placeholder="Nombre del bloque">
    <select id="block-grade"></select>
    <select id="block-zone"></select>
    <textarea id="block-notes" placeholder="Notas adicionales..."></textarea>

    <div id="new-block-actions">
        <button id="save-new-block">Seleccionar Presas</button>
        <button class="back-btn">Volver</button>
    </div>
</section>

<section id="canvas-section">
    <canvas id="block-canvas"></canvas>
    <div id="canvas-actions">
        <button id="toggle-manual-btn">Modo Manual: OFF</button>
        <button id="toggle-laterality-btn">Modo Lateralidad: OFF</button>
        <button id="save-canvas-block">Guardar Presas</button>
        <button class="back-btn">Volver</button>
    </div>
</section>

<section id="edit-block-section">
    <h2>Editar Bloque</h2>
    <input type="text" id="edit-block-name">
    <select id="edit-block-grade"></select>
    <select id="edit-block-zone"></select>
    <textarea id="edit-block-notes"></textarea>

    <button id="edit-holds-btn">Editar SelecciÃ³n de Presas</button>
    <button id="save-edit-block">Guardar Bloque</button>
    <button id="delete-block">Borrar Bloque</button>
    <button class="back-btn">Volver</button>
</section>

<script src="app.js"></script>
</body>
</html>
